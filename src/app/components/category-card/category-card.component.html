<div class="card">
  <div class="loading-indicator" *ngIf="loading === true">
    <mat-progress-spinner
      mode="indeterminate"
      color="accent"
    ></mat-progress-spinner>
  </div>
  <div class="action-container">
    <button
      class="button-category"
      (click)="onEditClick()"
      *ngIf="editMode === false"
    >
      <mat-icon>edit</mat-icon>
    </button>
    <button
      (click)="onDelete()"
      *ngIf="editMode === false"
      class="button-category"
      [disabled]="canMakeChanges ? false : true"
    >
      <mat-icon>delete</mat-icon>
    </button>
    <button
      class="button-category"
      *ngIf="editMode === true"
      (click)="onSubmitForm()"
    >
      <mat-icon>save</mat-icon>
    </button>
    <button
      class="button-category"
      *ngIf="editMode === true"
      (click)="onDiscard()"
    >
      <mat-icon>close</mat-icon>
    </button>
  </div>
  <form [formGroup]="categoryForm">
    <div class="segment flex-center">
      <mat-form-field appearance="fill">
        <mat-label> Title. </mat-label>
        <input
          matInput
          [readonly]="canMakeChanges && editMode ? null : true"
          formControlName="titleControl"
          placeholder="Choose category name."
        />
        <mat-error
          *ngIf="
            categoryForm.get('titleControl')!.hasError('required') &&
            categoryForm.touched
          "
        ></mat-error>
      </mat-form-field>
    </div>

    <div class="segment flex-center">
      <div class="centered-segment flex-center">
        <app-upload-file
          [form]="categoryForm"
          [hidden]="editMode ? false : true"
          controlName="backgroundControl"
          runMode="base64"
        ></app-upload-file>
        <div>Background image.</div>
      </div>
    </div>

    <div class="background-segment flex-center">
      <img
        [src]="categoryForm.get('backgroundControl')!.value || '/assets/chooseImage.png'"
        class="bg-img"
      />
    </div>

    <div class="segment flex-center">
      <div class="centered-segment flex-center">
        <app-upload-file
          [form]="categoryForm"
          [hidden]="editMode ? false : true"
          controlName="iconControl"
          runMode="base64"
        ></app-upload-file>
        <div>Category icon.</div>
      </div>
    </div>
    <div class="icon-segment flex-center">
      <img
        [src]="categoryForm.get('iconControl')!.value || '/assets/chooseImage.png'"
        class="icon"
      />
    </div>
  </form>
</div>
